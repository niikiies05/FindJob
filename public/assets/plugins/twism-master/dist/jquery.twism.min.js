!function(t){t.fn.twism=function(){var e=this;"string"==typeof arguments[0]?(action=arguments[0],options=arguments[1]||null,callback=arguments[2]||null):"object"==typeof arguments[0]?(action="create",options=arguments[0],callback=arguments[1]||null):"function"==typeof arguments[0]?(action="create",options=null,callback=arguments[0]):(action="create",options=null,callback=null);var l=function(t,l){e.remove(),"function"==typeof l&&l()},o=function(t,e,l,o,r,i,n){try{var s=document.createElementNS("http://www.w3.org/2000/svg","text");if(t&&"function"==typeof t.getBBox&&l&&o){t.getBBox();s.setAttribute("transform","translate("+l+" "+o+")"),s.textContent=e,s.setAttribute("id",e),s.setAttribute("fill",r),s.setAttribute("font-size",n),s.setAttribute("font-family",i),t.parentNode.insertBefore(s,t.nextSibling)}}catch(a){}},r=function(t,e,l,r,i,n,s){try{var a=document.createElementNS("http://www.w3.org/2000/svg","rect");p=document.getElementsByTagName("svg")[0];p.viewBox.baseVal;a.setAttribute("id",t),a.setAttribute("fill",l),a.setAttribute("stroke",r),a.setAttribute("stroke-width","1"),a.setAttribute("x",p.getBBox().width-40),a.setAttribute("y",e),a.setAttribute("width","40"),a.setAttribute("height","20"),p.appendChild(a),o(a,t,p.getBBox().width-30,e+15,i,n,s)}catch(u){}},n=function(l,n){var s=t.extend({map:"world",customMap:!1,territories:!0,antarctica:!1,color:"#A9DA8A",border:"white",align:"center",backgroundColor:"#4af",borderWidth:"2",height:null,width:null,click:function(t){t&&alert(t)},hover:function(){},unhover:function(){},hoverColor:"#BB0029",hoverBorder:"yellow",littleRedBook:!0,hideCountries:!1,disableCountries:[],individualCountrySettings:!1,labels:!1,labelAttributes:{color:"white",font:"Helvetica",fontSize:"15"}},l),a=e;if(a.css({width:s.width||"100%",height:s.height||"100%"}),"world"==s.map)var u=s.antarctica?"world-map-with-antarctica.svg":"world-map.svg";else if("usa"==s.map){var u="Blank_US_territories.svg";s.territories||(s.hideCountries||(s.hideCountries=[]),s.hideCountries.push("VI"),s.hideCountries.push("GU"),s.hideCountries.push("MP"),s.hideCountries.push("AS"),s.hideCountries.push("PR"))}else if("custom"==s.map){var b=s.customMap;s.territories||(s.hideCountries||(s.hideCountries=[]),s.hideCountries.push("VI"),s.hideCountries.push("GU"),s.hideCountries.push("MP"),s.hideCountries.push("AS"),s.hideCountries.push("PR"))}if("undefined"!=typeof require&&"custom"!=s.map){b=require.toUrl("twism").replace("jquery.twism","maps/"+u)}else b=s.customMap?s.customMap:"dist/maps/"+u;return a.load(b,null,function(e){t("svg",a).attr({height:"100%",width:"100%"}).css({background:s.backgroundColor,height:"100%",width:"100%"});var l=s.hideCountries;for(i in l)t("path#"+l[i]+", rect#"+l[i],a).remove();if(s.labels&&("usa"==s.map||"custom"==s.map)){var u=(document.querySelectorAll("path"),["NH","VT","MA","RI","CT","NJ","DE","MD","DC"]);o(document.getElementById("HI"),"HI",300,575,s.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("AK"),"AK",110,500,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("FL"),"FL",755,511,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("SC"),"SC",752,380,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("GA"),"GA",700,405,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("AL"),"AL",645,415,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("NC"),"NC",767,332,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("TN"),"TN",647,345,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("ME"),"ME",885,86,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("NY"),"NY",807,155,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("PA"),"PA",770,211,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("WV"),"WV",735,275,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("KY"),"KY",665,305,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("OH"),"OH",694,236,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("MI"),"MI",650,175,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("WY"),"WY",293,181,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("MT"),"MT",273,86,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("ID"),"ID",183,151,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("WA"),"WA",116,48,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("TX"),"TX",404,452,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("CA"),"CA",65,280,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("AZ"),"AZ",193,364,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("NV"),"NV",132,251,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("UT"),"UT",216,248,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("CO"),"CO",317,272,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("NM"),"NM",297,373,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("OR"),"OR",96,118,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("ND"),"ND",408,92,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("SD"),"SD",408,163,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("NE"),"NE",408,223,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("IA"),"IA",523,214,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("MS"),"MS",588,418,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("IN"),"IN",644,255,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("IL"),"IL",590,260,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("MN"),"MN",495,116,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("WI"),"WI",574,151,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("MO"),"MO",535,294,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("AR"),"AR",537,375,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("OK"),"OK",432,361,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("KS"),"KS",439,291,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("LA"),"LA",538,456,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),o(document.getElementById("VA"),"VA",778,282,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize);var b=200;_.each(u,function(t){r(t,b,s.labelAttributes.backgroundColor||s.color,s.borderColor,s.labelAttributes.color,s.labelAttributes.font,s.labelAttributes.fontSize),b+=25})}t("svg path, svg rect",a).css({fill:s.color,stroke:s.border,strokeWidth:s.borderWidth});var c=s.individualCountrySettings;for(i in c)t("svg path#"+c[i].name+", svg rect#"+c[i].name,a).css({fill:c[i].color||s.color,stroke:c[i].border||s.border});t("svg",a).on("click",function(e){lastclicked=t(e.target).attr("id"),s.click(lastclicked)}),t("svg",a).on("mouseover",function(e){lastclicked=t(e.target).attr("id"),s.hover(lastclicked)}),t("svg",a).on("mouseout",function(e){lastclicked=t(e.target).attr("id"),s.unhover(lastclicked)}),t("svg path, svg rect, svg text",a).on("mouseover",function(e){if(c&&c.length)var l=t.map(c,function(t){return t.name});var o=t(e.target).attr("id");if(s.disableCountries&&-1==s.disableCountries.indexOf(o)){if(c&&l.indexOf(o)>-1)for(i in c)c[i].name==o&&t("svg path#"+c[i].name+", svg rect#"+c[i].name,a).css({fill:c[i].hoverColor||s.hoverColor,stroke:c[i].hoverBorder||s.hoverBorder});else t("path#"+o+", rect#"+o,a).css({fill:s.hoverColor,stroke:s.hoverBorder});s.littleRedBook&&("cn"==o||"tw"==o||"hk"==o||"mc"==o)&&t("path#tw, path#cn, path#hk, path#mc").css({fill:s.hoverColor,stroke:s.hoverBorder})}}),t("svg path, svg text, svg rect",a).on("mouseout",function(e){var l=t(e.target).attr("id");t("path#"+l+", rect#"+l,a).css({fill:s.color,stroke:s.border});for(i in c)t("svg rect#"+c[i].name+", svg path#"+c[i].name,a).css({fill:c[i].color||s.color,stroke:c[i].border||s.border});s.littleRedBook&&("cn"==l||"tw"==l||"hk"==l||"mc"==l)&&t("path#tw, path#cn, path#hk, path#mc").css({fill:s.color,stroke:s.border})}),"function"==typeof n&&n()}),a},s=function(e){e.color&&(t("svg path#"+e.name+", svg rect#"+e.name).css({fill:e.color}),t("svg path#"+e.name+", svg rect#"+e.name).on("mouseout",function(){t(this).css({fill:e.color})})),e.border&&(t("svg path#"+e.name+", svg rect#"+e.name).css({stroke:e.border}),t("svg path#"+e.name+", svg rect#"+e.name).on("mouseout",function(){t(this).css({stroke:e.border})})),e.borderWidth&&t("svg path#"+e.name+", svg rect#"+e.name).css({strokeWidth:e.borderWidth}),e.hoverColor&&(t("svg path#"+e.name+", svg text#"+e.name+", svg rect#"+e.name).on("mouseover",function(l){t("svg path#"+e.name).css({fill:e.hoverColor}),e.hoverBorder&&t("svg path#"+e.name+", svg text#"+e.name+", svg rect#"+e.name).css({stroke:e.hoverBorder})}),t("svg path#"+e.name+", svg text#"+e.name+", svg rect#"+e.name).on("mouseout",function(l){t("svg path#"+e.name).css({fill:e.color}),e.hoverBorder&&t("svg path#"+e.name+", svg text#"+e.name+", svg rect#"+e.name).css({stroke:e.border})})),e.click&&t("svg path#"+e.name+", svg text#"+e.name+", svg rect#"+e.name).on("click",function(l){l.stopPropagation(),lastclicked=t(l.target).attr("id"),e.click(lastclicked)}),e.hover&&t("svg path#"+e.name+", svg text#"+e.name+", svg rect#"+e.name).on("mouseover",function(l){l.stopPropagation(),lastclicked=t(l.target).attr("id"),e.hover(lastclicked)})};switch(action){case"create":return n(options,callback);case"destroy":return l(options,callback);case"setCountry":return s(options);default:return n(options,callback)}}}(jQuery);